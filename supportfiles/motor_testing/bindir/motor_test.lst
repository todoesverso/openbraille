MPASM  5.03                    MOTOR_TEST.ASM   1-9-2009  21:10:46         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;############################################################
                      00002 ;
                      00003 ;        Stepper Motor controller
                      00004 ;        Autor: German Sanguinetti
                      00005 ;############################################################
Warning[215]: Processor superseded by command line.  Verify processor symbol.
                      00006         list            p=pic16f877a
                      00007         include         p16f877a.inc
Error[113]  : Symbol not previously defined (_hs_osc)
Error[113]  : Symbol not previously defined (_wdt_off)
Error[113]  : Symbol not previously defined (_pwrte_on)
Error[113]  : Symbol not previously defined (_cp_off)
2007   0000           00008         __config _hs_osc & _wdt_off & _pwrte_on & _cp_off
                      00009         errorlevel      -302    ;para el msg de bank warning
                      00010 
                      00011 ;###############  Definicion de etiquetas  ############### 
                      00012 
                      00013         cblock  h'0c'
  0000000C            00014 mode                            ;modo de operacion
                      00015                                 ;0=PARAR 1=DER 2=IZQ
  0000000D            00016 cuenta1                         ;contador de delay
  0000000E            00017 cuenta2                         ;contador delay (mseg)
                      00018         endc
                      00019 
                      00020 ;Definicion PORTB 
  00000000            00021 rb0     equ     0               ;B0
  00000001            00022 rb1     equ     1               ;B1 
  00000002            00023 rb2     equ     2               ;B2
  00000005            00024 rb5     equ     5               ;B5 
  00000007            00025 rb7     equ     7               ;B7
                      00026 
                      00027 ;###############    Inicio de programa     ############### 
                      00028         org     0               ;restablecer vector
0000   2???           00029         goto    init
                      00030         org     4               ;vector interrupcion
Error[113]  : Symbol not previously defined (intcon)
0004   0180           00031         clrf    intcon          ;reestablecer reg interruption
                      00032 
                      00033 ;###############      Proceso inicial      ############### 
0005                  00034 init
Error[113]  : Symbol not previously defined (status)
Error[113]  : Symbol not previously defined (rp0)
0005   1400           00035         bsf     status,rp0      ;cambiar a bank1
Error[113]  : Symbol not previously defined (trisa)
0006   0180           00036         clrf    trisa           ;establecer portA en OUT
0007   3027           00037         movlw   b'00100111'     ;b0,1,2,5=IN b7=OUT
Error[113]  : Symbol not previously defined (trisb)
0008   0080           00038         movwf   trisb           ;establecer portB
0009   3080           00039         movlw   b'10000000'     ;bpu=1 pullup no usado
Error[113]  : Symbol not previously defined (option_reg)
000A   0080           00040         movwf   option_reg      ;establecer option_reg
Error[113]  : Symbol not previously defined (status)
Error[113]  : Symbol not previously defined (rp0)
MPASM  5.03                    MOTOR_TEST.ASM   1-9-2009  21:10:46         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B   1000           00041         bcf     status,rp0      ;cambiar a bank0
000C   018C           00042         clrf    mode            ;establecer modo=PARAR 
000D   018D           00043         clrf    cuenta1         ;limpiar contador
000E   018E           00044         clrf    cuenta2         ;limpiar contador
000F   3005           00045         movlw   b'00000101'     ;establecer portA a valor inicial
Error[113]  : Symbol not previously defined (porta)
0010   0080           00046         movwf   porta           ;escribir portA
Error[113]  : Symbol not previously defined (portb)
0011   1780           00047         bsf     portb,rb7       ;establecer b7=1
Error[113]  : Symbol not previously defined (portb)
0012   1A80           00048         btfsc   portb,rb5       ;b5=0 ?
0013   2???           00049         goto    $-1             ;no.  esperar
                      00050 
0014                  00051 start
                      00052 
                      00053 ;###############    Verificar condicion    ############### 
Error[113]  : Symbol not previously defined (portb)
0014   1880           00054         btfsc   portb,rb1       ;B1(PARAR) = ON ?
0015   2???           00055         goto    verificar1      ;no.  siguiente
0016   018C           00056         clrf    mode            ;si. establecer PARAR modo
0017   2???           00057         goto    drive           ;no.  saltar a motor drive
0018                  00058 verificar1
Error[113]  : Symbol not previously defined (portb)
0018   1900           00059         btfsc   portb,rb2       ;B2(DER) = ON ?
0019   2???           00060         goto    verificar2      ;no.  siguiente
001A   3001           00061         movlw   d'1'            ;si. establecer modo derecha 
001B   008C           00062         movwf   mode            ;grabar modo
001C   2???           00063         goto    drive           ;no.  saltar a motor drive
001D                  00064 verificar2
Error[113]  : Symbol not previously defined (portb)
001D   1800           00065         btfsc   portb,rb0       ;B0(IZQ) = ON ?
001E   2???           00066         goto    drive           ;no.  saltar a motor drive
001F   3002           00067         movlw   d'2'            ;si. establecer modo izquierda 
0020   008C           00068         movwf   mode            ;grabar modo
                      00069 
                      00070 ;####################  Motor drive  #####################
0021                  00071 drive
0021   080C           00072         movf    mode,w          ;leer modo
0022   1903 2???      00073         bz      start           ;modo = PARAR
Error[113]  : Symbol not previously defined (portb)
0024   1780           00074         bsf     portb,rb7       ;establecer B7 = 1
Error[113]  : Symbol not previously defined (portb)
0025   1A80           00075         btfsc   portb,rb5       ;B5 = 0 ?
0026   2???           00076         goto    $-1             ;no.  esperar
0027   3005           00077         movlw   d'5'            ;establecer loop cuenta(5msec)
0028   008D           00078         movwf   cuenta1         ;grabar loop cuenta
0029   2???           00079 loop    call    timer           ;esperar 1msec
002A   0B8D           00080         decfsz  cuenta1,f       ;cuenta - 1 = 0 ?
002B   2???           00081         goto    loop            ;no.  continuar
Error[113]  : Symbol not previously defined (portb)
002C   1380           00082         bcf     portb,rb7       ;establecer B7 = 0
Error[113]  : Symbol not previously defined (portb)
002D   1E80           00083         btfss   portb,rb5       ;B5 = 1 ?
MPASM  5.03                    MOTOR_TEST.ASM   1-9-2009  21:10:46         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002E   2???           00084         goto    $-1             ;no.  esperar
Error[113]  : Symbol not previously defined (porta)
002F   0800           00085         movf    porta,w         ;leer portA
0030   3C05           00086         sublw   b'000000101'    ;verificar motor  
0031   1D03 2???      00087         bnz     drive2          ;proximo
0033   080C           00088         movf    mode,w          ;leer modo
0034   3C01           00089         sublw   d'1'            ;esta bien ?
0035   1903 2???      00090         bz      drive1          ;si. esta bien
0037   3009           00091         movlw   b'00001001'     ;no.  establecer izquierda  
0038   2???           00092         goto    drive_end       ;saltar a portA  
0039                  00093 drive1
0039   3006           00094         movlw   b'00000110'     ;establecer derecha  
003A   2???           00095         goto    drive_end       ;saltar a portA  
                      00096 ;-------------------------------------------------
003B                  00097 drive2
Error[113]  : Symbol not previously defined (porta)
003B   0800           00098         movf    porta,w         ;leer portA
003C   3C06           00099         sublw   b'000000110'    ;verificar motor  
003D   1D03 2???      00100         bnz     drive4          ;proximo
003F   080C           00101         movf    mode,w          ;leer modo
0040   3C01           00102         sublw   d'1'            ;esta bien ?
0041   1903 2???      00103         bz      drive3          ;si. esta bien
0043   3005           00104         movlw   b'00000101'     ;no.  establecer izquierda  
0044   2???           00105         goto    drive_end       ;saltar a portA  
0045                  00106 drive3
0045   300A           00107         movlw   b'00001010'     ;establecer derecha  
0046   2???           00108         goto    drive_end       ;saltar a portA  
                      00109 ;-------------------------------------------------
0047                  00110 drive4
Error[113]  : Symbol not previously defined (porta)
0047   0800           00111         movf    porta,w         ;leer portA
0048   3C0A           00112         sublw   b'000001010'    ;verificar motor  
0049   1D03 2???      00113         bnz     drive6          ;proximo
004B   080C           00114         movf    mode,w          ;leer modo
004C   3C01           00115         sublw   d'1'            ;esta bien ?
004D   1903 2???      00116         bz      drive5          ;si. esta bien
004F   3006           00117         movlw   b'00000110'     ;no.  establecer izquierda  
0050   2???           00118         goto    drive_end       ;saltar a portA  
0051                  00119 drive5
0051   3009           00120         movlw   b'00001001'     ;establecer derecha  
0052   2???           00121         goto    drive_end       ;saltar a portA  
                      00122 ;-------------------------------------------------
0053                  00123 drive6
Error[113]  : Symbol not previously defined (porta)
0053   0800           00124         movf    porta,w         ;leer portA
0054   3C09           00125         sublw   b'000001001'    ;verificar motor  
0055   1D03 2???      00126         bnz     drive8          ;proximo
0057   080C           00127         movf    mode,w          ;leer modo
0058   3C01           00128         sublw   d'1'            ;esta bien ?
0059   1903 2???      00129         bz      drive7          ;si. esta bien
005B   300A           00130         movlw   b'00001010'     ;no.  establecer izquierda  
005C   2???           00131         goto    drive_end       ;saltar a portA  
005D                  00132 drive7
MPASM  5.03                    MOTOR_TEST.ASM   1-9-2009  21:10:46         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

005D   3005           00133         movlw   b'00000101'     ;establecer derecha  
005E   2???           00134         goto    drive_end       ;saltar a portA  
                      00135 ;-------------------------------------------------
005F                  00136 drive8
005F   3005           00137         movlw   b'00000101'     ;establecer est inicial
                      00138 
0060                  00139 drive_end
Error[113]  : Symbol not previously defined (porta)
0060   0080           00140         movwf   porta           ;escribir portA
0061   2???           00141         goto    start           ;saltar a inicio
                      00142 ;###############   ############### 
                      00143 ;#############  1msec Timer Subroutine  #################
0062                  00144 timer
0062   30C8           00145         movlw   d'200'          ;establecer loop cuenta
0063   008E           00146         movwf   cuenta2          ;grabar loop cuenta
0064   0000           00147 tmlp    nop                     ;Time adjust
0065   0000           00148         nop                     ;Time adjust
0066   0B8E           00149         decfsz  cuenta2,f        ;cuenta - 1 = 0 ?
0067   2???           00150         goto    tmlp            ;no.  continuar
0068   0008           00151         return                  ;si. cuenta end
                      00152 
                      00153 ;########################################################
                      00154 ;            FIN!!!!!!! 
                      00155 ;########################################################
                      00156 
                      00157         end
MPASM  5.03                    MOTOR_TEST.ASM   1-9-2009  21:10:46         PAGE  5


SYMBOL TABLE
  LABEL                             VALUE 

_.org_1_0013                      00000013
_.org_1_0026                      00000026
_.org_1_002E                      0000002E
__16CXX                           00000001
cuenta1                           0000000D
cuenta2                           0000000E
drive                             00000021
drive1                            00000039
drive2                            0000003B
drive3                            00000045
drive4                            00000047
drive5                            00000051
drive6                            00000053
drive7                            0000005D
drive8                            0000005F
drive_end                         00000060
init                              00000005
loop                              00000029
mode                              0000000C
rb0                               00000000
rb1                               00000001
rb2                               00000002
rb5                               00000005
rb7                               00000007
start                             00000014
timer                             00000062
tmlp                              00000064
verificar1                        00000018
verificar2                        0000001D

Errors   :    27
Warnings :     1 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

